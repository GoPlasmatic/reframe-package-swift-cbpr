{
    "id": "camt056-preconditions",
    "name": "camt.056 to MT192/MT292 Preconditions",
    "description": "Validates preconditions for camt.056 to MT192/MT292 transformation",
    "priority": 3,
    "condition": { "and": [
        {"==": [{"var": "metadata.ISO20022_MX.message_type"}, "camt.056"]},
        {"==": [{"var": "metadata.transformation_direction"}, "mx-to-mt"]},
        {"==": [{"var": "metadata.progress.workflow_id"}, "camt056-variant-detection"]},
        {"==": [{"var": "metadata.progress.task_id"}, "detect_target_message"]},
        {"==": [{"var": "metadata.progress.status_code"}, 200]}
    ]},
    "tasks": [
        {
            "id": "validate_preconditions",
            "name": "Validate Preconditions",
            "description": "Validates all preconditions for MT192/MT292",
            "function": {
                "name": "validate",
                "input": {
                    "rules": [
                        {
                            "path": "data.ISO20022_MX.document",
                            "logic": {"exists": ["data", "ISO20022_MX", "Document", "FIToFIPmtCxlReq", "Undrlyg", "TxInf", "Case", "Id"]},
                            "message": "PREC01: Case/Identification is mandatory"
                        },
                        {
                            "path": "data.ISO20022_MX.document",
                            "logic": {"exists": ["data", "ISO20022_MX", "Document", "FIToFIPmtCxlReq", "Undrlyg", "TxInf", "OrgnlInstrId"]},
                            "message": "PREC02: OriginalInstructionIdentification is mandatory"
                        },
                        {
                            "path": "data.ISO20022_MX.document",
                            "logic": {"exists": ["data", "ISO20022_MX", "Document", "FIToFIPmtCxlReq", "Undrlyg", "TxInf", "OrgnlIntrBkSttlmAmt"]},
                            "message": "PREC03: OriginalInterbankSettlementAmount is mandatory"
                        },
                        {
                            "path": "data.ISO20022_MX.document",
                            "logic": {"exists": ["data", "ISO20022_MX", "Document", "FIToFIPmtCxlReq", "Undrlyg", "TxInf", "OrgnlIntrBkSttlmDt"]},
                            "message": "PREC04: OriginalInterbankSettlementDate is mandatory"
                        }
                    ]
                }
            }
        }
    ]
}
