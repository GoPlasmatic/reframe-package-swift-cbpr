{
    "id": "camt106-sender-receiver-info-mapping",
    "name": "camt.106 to MTn91 Sender to Receiver Information Mapping",
    "description": "Maps ChargesRequestor and InstructionForInstructedAgent to Field 72 per CBPR+ specification",
    "priority": 7,
    "condition": { "and": [
        {"==": [{"var": "metadata.ISO20022_MX.message_type"}, "camt.106"]},
        {"==": [{"var": "metadata.transformation_direction"}, "mx-to-mt"]},
        {"==": [{"var": "metadata.progress.workflow_id"}, "camt106-charges-and-agent-mapping"]},
        {"==": [{"var": "metadata.progress.status_code"}, 200]}
    ]},
    "tasks": [
        {
            "id": "map_sender_receiver_info",
            "name": "Map Sender to Receiver Information (Field 72)",
            "description": "Maps ChargesRequestor and InstructionForInstructedAgent to Field 72",
            "function": {
                "name": "map",
                "input": {
                    "mappings": [
                        {
                            "path": "data.SwiftMT.fields.#72.information",
                            "logic": [
                                {
                                    "cat": [
                                        "/",
                                        {"var": "data.ISO20022_MX.Document.ChrgsPmtReq.Chrgs.PerTx.Rcrd.InstrForInstdAgt.Cd"},
                                        "/"
                                    ]
                                },
                                {"var": "data.ISO20022_MX.Document.ChrgsPmtReq.Chrgs.PerTx.Rcrd.InstrForInstdAgt.InstrInf"},
                                {
                                    "cat": [
                                        "/CHRQ/",
                                        {"var": "data.ISO20022_MX.Document.ChrgsPmtReq.GrpHdr.ChrgsRqstr.FinInstnId.BICFI"}
                                    ]
                                }
                            ]
                        }
                    ]
                }
            }
        }
    ]
}
